* K:\Git_personal\EASY_MRI_RFPA\LTSPICE simulations\Easy_DICO\DICO_giangrandi_flipped_simple.asc
LP1 p1 p2 {T_Lp} Rser={T_DCRp}
LS1 0 p4 {T_Ls} Rser={T_DCRs} Cpar={T_Cs}
R1 P001 0 50
RL loadport 0 50
VS sourceport 0 AC 1 Rser=50
S1 P001 p4 N010 0 MuxSwitch
S2 loadport p4 N011 0 MuxSwitch
S3 sourceport p4 N012 0 MuxSwitch
B1 N011 0 V={if(abs(load_port-4)<0.1,1,0)}
B2 N012 0 V={if(abs(source_port-4)<0.1,1,0)}
B3 N010 0 V=(if((abs(load_port-4)>=0.1) & (abs(source_port-4)>=0.1),1,0))
R3 P002 0 50
S4 P002 p3 N007 0 MuxSwitch
S5 loadport p3 N008 0 MuxSwitch
S6 sourceport p3 N009 0 MuxSwitch
B4 N008 0 V={if(abs(load_port-3)<0.1,1,0)}
B5 N009 0 V={if(abs(source_port-3)<0.1,1,0)}
B6 N007 0 V=(if((abs(load_port-3)>=0.1) & (abs(source_port-3)>=0.1),1,0))
R2 P003 0 50
S7 P003 p2 N004 0 MuxSwitch
S8 loadport p2 N005 0 MuxSwitch
S9 sourceport p2 N006 0 MuxSwitch
B7 N005 0 V={if(abs(load_port-2)<0.1,1,0)}
B8 N006 0 V={if(abs(source_port-2)<0.1,1,0)}
B9 N004 0 V=(if((abs(load_port-2)>=0.1) & (abs(source_port-2)>=0.1),1,0))
R4 P004 0 50
S10 P004 p1 N001 0 MuxSwitch
S11 loadport p1 N002 0 MuxSwitch
S12 sourceport p1 N003 0 MuxSwitch
B10 N002 0 V={if(abs(load_port-1)<0.1,1,0)}
B11 N003 0 V={if(abs(source_port-1)<0.1,1,0)}
B12 N001 0 V=(if((abs(load_port-1)>=0.1) & (abs(source_port-1)>=0.1),1,0))
C1 p1 0 {Cff1}
C2 p2 p4 {Css1}
C3 p2 0 {Csf1}
C4 p1 p4 {Cfs1}
LP2 p3 p4 {T_Lp} Rser={T_DCRp}
LS2 p2 0 {T_Ls} Rser={T_DCRs} Cpar={T_Cs}
C5 p3 p2 {Cff2}
C6 p4 0 {Css2}
C7 p4 p2 {Csf2}
C8 p3 0 {Cfs2}
C9 p1 p3 0.01p
C10 p2 p4 0.01p
.param T_Ls=81u
.param T_Ns=20
.param T_DCRp=0.0007
.param T_DCRs=0.4
.param T_Cs=1p
.param T_K=1
.param T_Lp={T_Ls/T_Ns**2}
K1 LP1 LS1 {T_K}
K2 LP2 LS2 {T_K}
.ac dec 1k 100k 10meg
.net I(RL) VS
.model MuxSwitch SW(Ron=.0001 Roff=10Meg Vt=0.5 Vh=0 Lser=0 Vser=0)
; fudge a more sophisticated network analysis by doing several two port analyses in a sweep
.param load_port=3
.step param load_port LIST 3 4
.param source_port=1
.step param source_port LIST 1 2
.param ftest=1meg
.meas ftest PARAM {ftest}
.meas AC S21_at_ftest FIND (S21(vs)) AT ftest
.param Cff1=0.01p
.param Css1=0.01p
.param Csf1=0.01p
.param Cfs1=0.01p
.param Cff2=.01n
.param Css2=.01p
.param Csf2=0.01p
.param Cfs2=0.01p
.backanno
.end
