Version 4
SHEET 1 2268 924
WIRE -368 -80 -512 -80
WIRE -240 -80 -368 -80
WIRE -128 -80 -240 -80
WIRE -64 -80 -128 -80
WIRE 64 -80 -64 -80
WIRE 80 -80 64 -80
WIRE 176 -80 160 -80
WIRE 208 -80 176 -80
WIRE 304 -80 208 -80
WIRE 336 -80 304 -80
WIRE 384 -80 336 -80
WIRE 560 -80 384 -80
WIRE 704 -80 560 -80
WIRE 832 -80 704 -80
WIRE 176 -48 176 -80
WIRE 176 -48 112 -48
WIRE 64 -32 64 -80
WIRE 160 -32 64 -32
WIRE -512 -16 -512 -80
WIRE -368 -16 -368 -80
WIRE -240 -16 -240 -80
WIRE 64 -16 64 -32
WIRE 112 -16 112 -48
WIRE 160 -16 160 -32
WIRE 208 -16 208 -80
WIRE 560 -16 560 -80
WIRE 704 -16 704 -80
WIRE 832 -16 832 -80
WIRE -560 0 -592 0
WIRE -416 0 -448 0
WIRE -288 0 -320 0
WIRE 512 0 480 0
WIRE 656 0 624 0
WIRE 784 0 752 0
WIRE 160 64 160 48
WIRE 208 64 208 48
WIRE 208 64 160 64
WIRE -368 80 -368 64
WIRE -240 80 -240 64
WIRE 64 80 64 48
WIRE 112 80 112 48
WIRE 112 80 64 80
WIRE 704 80 704 64
WIRE 832 80 832 64
WIRE 64 96 64 80
WIRE 64 96 -48 96
WIRE 80 96 64 96
WIRE 208 96 208 64
WIRE 208 96 160 96
WIRE 320 96 208 96
WIRE 992 96 992 80
WIRE -736 128 -736 112
WIRE -48 128 -48 96
WIRE -592 160 -592 0
WIRE -448 160 -448 0
WIRE -320 160 -320 0
WIRE 480 160 480 0
WIRE 624 160 624 0
WIRE 752 160 752 0
WIRE -128 208 -128 -80
WIRE 304 208 304 -80
WIRE 304 208 0 208
WIRE 384 208 384 -80
WIRE 0 288 0 208
WIRE 48 288 0 288
WIRE 64 288 48 288
WIRE 192 288 144 288
WIRE 272 288 192 288
WIRE 272 304 272 288
WIRE 48 336 48 288
WIRE 96 336 48 336
WIRE 192 352 192 288
WIRE 192 352 144 352
WIRE 48 368 48 336
WIRE 96 368 96 336
WIRE 144 368 144 352
WIRE 192 368 192 352
WIRE 48 448 48 432
WIRE 144 448 144 432
WIRE 144 448 48 448
WIRE 96 464 96 432
WIRE 160 464 96 464
WIRE -336 496 -480 496
WIRE -208 496 -336 496
WIRE -176 496 -208 496
WIRE -128 496 -128 272
WIRE -128 496 -176 496
WIRE 48 496 48 448
WIRE 48 496 -128 496
WIRE 64 496 48 496
WIRE 160 496 160 464
WIRE 160 496 144 496
WIRE 192 496 192 432
WIRE 192 496 160 496
WIRE 320 496 320 96
WIRE 320 496 192 496
WIRE 368 496 320 496
WIRE 384 496 384 272
WIRE 384 496 368 496
WIRE 560 496 384 496
WIRE 704 496 560 496
WIRE 832 496 704 496
WIRE -480 560 -480 496
WIRE -336 560 -336 496
WIRE -208 560 -208 496
WIRE 560 560 560 496
WIRE 704 560 704 496
WIRE 832 560 832 496
WIRE -528 576 -560 576
WIRE -384 576 -416 576
WIRE -256 576 -288 576
WIRE 512 576 480 576
WIRE 656 576 624 576
WIRE 784 576 752 576
WIRE -336 656 -336 640
WIRE -208 656 -208 640
WIRE 704 656 704 640
WIRE 832 656 832 640
WIRE -560 736 -560 576
WIRE -416 736 -416 576
WIRE -288 736 -288 576
WIRE 480 736 480 576
WIRE 624 736 624 576
WIRE 752 736 752 576
FLAG -48 128 0
FLAG 992 176 0
FLAG -736 208 0
FLAG 512 624 0
FLAG 560 720 0
FLAG 656 624 0
FLAG 704 656 loadport
FLAG 784 624 0
FLAG 832 656 sourceport
FLAG 992 80 loadport
FLAG -736 112 sourceport
FLAG 624 816 0
FLAG 752 816 0
FLAG 480 816 0
FLAG -528 624 0
FLAG -480 720 0
FLAG -384 624 0
FLAG -336 656 loadport
FLAG -256 624 0
FLAG -208 656 sourceport
FLAG -416 816 0
FLAG -288 816 0
FLAG -560 816 0
FLAG 512 48 0
FLAG 560 144 0
FLAG 656 48 0
FLAG 704 80 loadport
FLAG 784 48 0
FLAG 832 80 sourceport
FLAG 624 240 0
FLAG 752 240 0
FLAG 480 240 0
FLAG -560 48 0
FLAG -512 144 0
FLAG -416 48 0
FLAG -368 80 loadport
FLAG -288 48 0
FLAG -240 80 sourceport
FLAG -448 240 0
FLAG -320 240 0
FLAG -592 240 0
FLAG -64 -80 p1
FLAG 336 -80 p2
FLAG -176 496 p3
FLAG 368 496 p4
FLAG 272 304 0
SYMBOL ind2 64 -96 M90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName LP1
SYMATTR Value {T_Lp}
SYMATTR Type ind
SYMATTR SpiceLine Rser={T_DCRp}
SYMBOL ind2 64 80 M90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName LS1
SYMATTR Value {T_Ls}
SYMATTR Type ind
SYMATTR SpiceLine Rser={T_DCRs} Cpar={T_Cs}
SYMBOL res 544 624 R0
SYMATTR InstName R1
SYMATTR Value 50
SYMBOL res 976 80 R0
SYMATTR InstName RL
SYMATTR Value 50
SYMBOL voltage -736 112 R0
WINDOW 123 24 124 Left 2
WINDOW 39 24 152 Left 2
SYMATTR Value2 AC 1
SYMATTR SpiceLine Rser=50
SYMATTR InstName VS
SYMATTR Value ""
SYMBOL sw 560 656 M180
SYMATTR InstName S1
SYMATTR Value MuxSwitch
SYMBOL sw 704 656 M180
SYMATTR InstName S2
SYMATTR Value MuxSwitch
SYMBOL sw 832 656 M180
SYMATTR InstName S3
SYMATTR Value MuxSwitch
SYMBOL bv 624 720 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V={if(abs(load_port-4)<0.1,1,0)}
SYMATTR InstName B1
SYMBOL bv 752 720 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V={if(abs(source_port-4)<0.1,1,0)}
SYMATTR InstName B2
SYMBOL bv 480 720 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V=(if((abs(load_port-4)>=0.1) & (abs(source_port-4)>=0.1),1,0))
SYMATTR InstName B3
SYMBOL res -496 624 R0
SYMATTR InstName R3
SYMATTR Value 50
SYMBOL sw -480 656 M180
SYMATTR InstName S4
SYMATTR Value MuxSwitch
SYMBOL sw -336 656 M180
SYMATTR InstName S5
SYMATTR Value MuxSwitch
SYMBOL sw -208 656 M180
SYMATTR InstName S6
SYMATTR Value MuxSwitch
SYMBOL bv -416 720 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V={if(abs(load_port-3)<0.1,1,0)}
SYMATTR InstName B4
SYMBOL bv -288 720 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V={if(abs(source_port-3)<0.1,1,0)}
SYMATTR InstName B5
SYMBOL bv -560 720 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V=(if((abs(load_port-3)>=0.1) & (abs(source_port-3)>=0.1),1,0))
SYMATTR InstName B6
SYMBOL res 544 48 R0
SYMATTR InstName R2
SYMATTR Value 50
SYMBOL sw 560 80 M180
SYMATTR InstName S7
SYMATTR Value MuxSwitch
SYMBOL sw 704 80 M180
SYMATTR InstName S8
SYMATTR Value MuxSwitch
SYMBOL sw 832 80 M180
SYMATTR InstName S9
SYMATTR Value MuxSwitch
SYMBOL bv 624 144 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V={if(abs(load_port-2)<0.1,1,0)}
SYMATTR InstName B7
SYMBOL bv 752 144 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V={if(abs(source_port-2)<0.1,1,0)}
SYMATTR InstName B8
SYMBOL bv 480 144 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V=(if((abs(load_port-2)>=0.1) & (abs(source_port-2)>=0.1),1,0))
SYMATTR InstName B9
SYMBOL res -528 48 R0
SYMATTR InstName R4
SYMATTR Value 50
SYMBOL sw -512 80 M180
SYMATTR InstName S10
SYMATTR Value MuxSwitch
SYMBOL sw -368 80 M180
SYMATTR InstName S11
SYMATTR Value MuxSwitch
SYMBOL sw -240 80 M180
WINDOW 3 -59 104 Left 2
SYMATTR InstName S12
SYMATTR Value MuxSwitch
SYMBOL bv -448 144 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V={if(abs(load_port-1)<0.1,1,0)}
SYMATTR InstName B10
SYMBOL bv -320 144 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V={if(abs(source_port-1)<0.1,1,0)}
SYMATTR InstName B11
SYMBOL bv -592 144 R0
WINDOW 3 24 96 Invisible 2
SYMATTR Value V=(if((abs(load_port-1)>=0.1) & (abs(source_port-1)>=0.1),1,0))
SYMATTR InstName B12
SYMBOL cap 48 -16 R0
WINDOW 3 -7 32 Right 2
SYMATTR InstName C1
SYMATTR Value {Cff1}
SYMBOL cap 192 -16 R0
WINDOW 3 28 31 Left 2
SYMATTR InstName C2
SYMATTR Value {Css1}
SYMBOL cap 96 -16 R0
WINDOW 3 21 56 Right 2
SYMATTR InstName C3
SYMATTR Value {Csf1}
SYMBOL cap 144 -16 R0
WINDOW 3 16 56 Left 2
SYMATTR InstName C4
SYMATTR Value {Cfs1}
SYMBOL ind2 48 512 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 VBottom 2
SYMATTR InstName LP2
SYMATTR Value {T_Lp}
SYMATTR Type ind
SYMATTR SpiceLine Rser={T_DCRp}
SYMBOL ind2 48 304 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 4 56 VBottom 2
SYMATTR InstName LS2
SYMATTR Value {T_Ls}
SYMATTR Type ind
SYMATTR SpiceLine Rser={T_DCRs} Cpar={T_Cs}
SYMBOL cap 32 432 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C5
SYMATTR Value {Cff2}
SYMBOL cap 176 432 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C6
SYMATTR Value {Css2}
SYMBOL cap 80 432 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C7
SYMATTR Value {Csf2}
SYMBOL cap 128 432 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C8
SYMATTR Value {Cfs2}
SYMBOL cap -144 208 R0
SYMATTR InstName C9
SYMATTR Value 0.01p
SYMBOL cap 368 208 R0
SYMATTR InstName C10
SYMATTR Value 0.01p
TEXT 32 -424 Left 2 !.param T_Ls=81u\n.param T_Ns=20\n.param T_DCRp=0.0007\n.param T_DCRs=0.4\n.param T_Cs=1p\n.param T_K=1\n \n.param T_Lp={T_Ls/T_Ns**2}\n \nK1 LP1 LS1 {T_K}\nK2 LP2 LS2 {T_K}
TEXT -480 832 Left 2 !.ac dec 1k 100k 10meg\n.net I(RL) VS
TEXT 544 -376 Left 2 !.model MuxSwitch SW(Ron=.0001 Roff=10Meg Vt=0.5 Vh=0 Lser=0 Vser=0)
TEXT 992 -224 Left 2 !; fudge a more sophisticated network analysis by doing several two port analyses in a sweep\n.param load_port=3\n.step param load_port LIST 3 4\n.param source_port=1\n.step param source_port LIST 1 2
TEXT 1200 16 Left 2 !.param ftest=1meg\n \n.meas ftest PARAM {ftest}\n.meas AC S21_at_ftest FIND (S21(vs)) AT ftest
TEXT -408 -384 Left 2 !.param Cff1=0.01p\n.param Css1=0.01p\n.param Csf1=0.01p\n.param Cfs1=0.01p
TEXT -392 -248 Left 2 !.param Cff2=.01n\n.param Css2=.01p\n.param Csf2=0.01p\n.param Cfs2=0.01p
