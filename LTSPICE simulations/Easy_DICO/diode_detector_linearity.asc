Version 4
SHEET 1 1440 888
WIRE 128 80 48 80
WIRE 144 80 128 80
WIRE 256 80 208 80
WIRE 304 80 256 80
WIRE 432 80 368 80
WIRE 560 80 432 80
WIRE 48 112 48 80
WIRE 432 112 432 80
WIRE 128 128 128 80
WIRE 256 128 256 80
WIRE 560 128 560 80
WIRE 48 208 48 192
WIRE 144 288 48 288
WIRE 192 288 144 288
WIRE 272 288 272 272
WIRE 272 288 256 288
WIRE 320 288 272 288
WIRE 432 288 400 288
WIRE 480 288 432 288
WIRE 496 288 480 288
WIRE 48 320 48 288
WIRE 432 320 432 288
WIRE 144 336 144 288
WIRE 272 336 272 288
WIRE 496 336 496 288
WIRE 48 416 48 400
WIRE 144 496 48 496
WIRE 192 496 144 496
WIRE 288 496 256 496
WIRE 336 496 288 496
WIRE 464 496 400 496
WIRE 544 496 464 496
WIRE 592 496 544 496
WIRE 48 528 48 496
WIRE 464 528 464 496
WIRE 144 544 144 496
WIRE 288 544 288 496
WIRE 592 544 592 496
WIRE 48 624 48 608
WIRE 144 704 48 704
WIRE 240 704 144 704
WIRE 400 704 304 704
WIRE 432 704 400 704
WIRE 560 704 512 704
WIRE 672 704 560 704
WIRE 48 736 48 704
WIRE 144 752 144 704
WIRE 400 752 400 704
WIRE 560 800 560 784
WIRE 48 832 48 816
FLAG 48 208 0
FLAG 432 192 0
FLAG 128 208 0
FLAG 560 192 0
FLAG 48 624 0
FLAG 464 608 0
FLAG 144 624 0
FLAG 592 608 0
FLAG 288 608 0
FLAG 48 416 0
FLAG 144 416 0
FLAG 496 400 0
FLAG 272 400 0
FLAG 560 80 det1
FLAG 480 288 det2
FLAG 544 496 det3
FLAG -80 288 0
FLAG 256 208 0
FLAG 432 400 0
FLAG 48 832 0
FLAG 144 832 0
FLAG 400 816 0
FLAG 672 704 det4
FLAG 560 864 0
SYMBOL voltage 48 96 M0
WINDOW 123 24 124 Left 2
WINDOW 39 24 152 Left 2
SYMATTR InstName V1
SYMATTR Value SINE(0 {e0} {ftest} 0 0 0 {ftest*tpulse})
SYMATTR Value2 AC 1
SYMATTR SpiceLine Rser=50
SYMBOL diode 304 96 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value DI_1N5711
SYMBOL res 416 96 R0
SYMATTR InstName R1
SYMATTR Value {Rdet}
SYMBOL res 112 112 R0
SYMATTR InstName R2
SYMATTR Value 68
SYMBOL cap 544 128 R0
SYMATTR InstName C1
SYMATTR Value {Cdet}
SYMBOL voltage 48 304 M0
WINDOW 123 24 124 Left 2
WINDOW 39 24 152 Left 2
SYMATTR InstName V2
SYMATTR Value SINE(0 {e0} {ftest} 0 0 0 {ftest*tpulse})
SYMATTR Value2 AC 1
SYMATTR SpiceLine Rser=50
SYMBOL diode 336 512 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value DI_1N5711
SYMBOL res 448 512 R0
SYMATTR InstName R3
SYMATTR Value {Rdet}
SYMBOL res 128 528 R0
SYMATTR InstName R4
SYMATTR Value 68
SYMBOL cap 576 544 R0
SYMATTR InstName C2
SYMATTR Value {Cdet}
SYMBOL cap 256 480 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 500p
SYMBOL diode 304 608 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value DI_1N5711
SYMBOL voltage 48 512 M0
WINDOW 123 24 124 Left 2
WINDOW 39 24 152 Left 2
SYMATTR InstName V3
SYMATTR Value SINE(0 {e0} {ftest} 0 0 0 {ftest*tpulse})
SYMATTR Value2 AC 1
SYMATTR SpiceLine Rser=50
SYMBOL diode 288 400 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMATTR Value DI_1N5711
SYMBOL res 416 304 R0
SYMATTR InstName R5
SYMATTR Value {Rdet}
SYMBOL res 128 320 R0
SYMATTR InstName R6
SYMATTR Value 68
SYMBOL cap 480 336 R0
SYMATTR InstName C4
SYMATTR Value {Cdet}
SYMBOL cap 256 272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value 500p
SYMBOL cap -80 272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 1n
SYMBOL cap 208 64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value 500p
SYMBOL ind 240 112 R0
SYMATTR InstName L1
SYMATTR Value 100µ
SYMBOL ind 304 304 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 100µ
SYMBOL diode 240 720 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D5
SYMATTR Value DI_1N5711
SYMBOL res 544 688 R0
SYMATTR InstName R7
SYMATTR Value {Rdet/2}
SYMBOL res 128 736 R0
SYMATTR InstName R8
SYMATTR Value 68
SYMBOL cap 384 752 R0
SYMATTR InstName C8
SYMATTR Value {Cdet}
SYMBOL voltage 48 720 M0
WINDOW 123 24 124 Left 2
WINDOW 39 24 152 Left 2
SYMATTR InstName V4
SYMATTR Value SINE(0 {e0} {ftest} 0 0 0 {ftest*tpulse})
SYMATTR Value2 AC 1
SYMATTR SpiceLine Rser=50
SYMBOL diode 544 800 R0
SYMATTR InstName D6
SYMATTR Value DI_1N5711
SYMBOL res 528 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value {Rdet/2}
TEXT 296 -248 Left 2 !.include ../Models and subcircuits/1N5711.mod
TEXT 320 -288 Left 2 ;.tran 0 {tsettle+tmeas} tsettle
TEXT -440 -200 Left 2 !.param Pin_dBm=20\n.step param Pin_dBm -10 20 3\n.param ftest=3meg\n.param Pin_W={10**(Pin_dBm/10)/1000}\n.param e0={sqrt(Pin_W*50)*1.414}\n;.param tsettle=1u\n.param tpulse=1m\n;.param tmeas={10/ftest}\n \n.param tsettle=1u\n.param tmeas=2m\n \n.tran 0 {tsettle+tmeas} {tsettle}
TEXT 440 -168 Left 2 !.param Cdet=1n\n.param Rdet=10k
TEXT 696 128 Left 2 !.meas TRAN Vdet1 AVG V(det1)\n.meas TRAN Vdet1_dBm PARAM 10* log10(Vdet1**2/50*1000)\n.meas TRAN Vdet2 AVG V(det2)\n.meas TRAN Vdet2_dBm PARAM 10* log10(Vdet2**2/50*1000)\n.meas TRAN Vdet3 AVG V(det3)\n.meas TRAN Vdet3_dBm PARAM 10* log10(Vdet3**2/50*1000)\n.meas TRAN Vdet4 AVG V(det4)\n.meas TRAN Vdet4_dBm PARAM 10* log10(Vdet4**2/50*1000)
